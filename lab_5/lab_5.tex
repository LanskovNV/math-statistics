\documentclass[12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphics}
\usepackage[english, russian]{babel}
\usepackage{csquotes}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{longtable}
\usepackage[left=25mm, top=20mm, right=25mm, bottom=30mm,nohead,nofoot]{geometry}
\usepackage{verbatim}
\usepackage{hyperref}
\usepackage{amssymb,latexsym}  % Standard packages
\usepackage{MnSymbol}
\usepackage{mathrsfs}
\usepackage{amsthm}
\usepackage{indentfirst}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage{float}

%******************************************************************
%******************************************************************

\setcounter{tocdepth}{4}
\graphicspath{ {./pic/} }

\begin{document}

\begin{titlepage}
	\center
		Санкт-Петербургский Политехнический 
		университет Петра Великого
		Институт прикладной математики и механики
		\\ \textbf{Кафедра «Прикладная математика»}

	\vfill ~
	\textbf{
		\\ \large ЛАБОРАТОРНАЯ РАБОТА №5
	}
	\\	по дисциплине 
	\\	"Математическая статистика"

	\vfill ~

	Выполнил студент гр. \textbf{33631/1} \\
	\textbf{Лансков.Н.В.} \\ 

\vfill

{\large}	Санкт-Петербург
\\ 2019
\end{titlepage}

%%%
% Table of conetnts 
%%%
% \settocdepth{chapter}
\tableofcontents
\newpage
% \listoffigures
% \newpage
\listoftables
\newpage
\pagebreak

% \setcounter{chapter}{1}

%%%
% Text
%%%
\section{Постановка задачи}
Необходимо построить выборки объёмом $20, 60, 100, 1000$ для двумерного нормального распределения с коэффициентами корреляции $\rho = 0, 0.5, 0.9$

Вычислить коэффициент корреляции Пирсона, Спирмана и квадрантный коэффициент корреляции для каждой выборки. Эти же вычисления повторить для смеси двумерных нормальных распределений \cite{mix}: 
\begin{equation}
    f(x,y) = 0.9N(x,y,0,0,1,1,0.9)+0.1N(x,y,0,0,10,10,-0.9)
\end{equation}
На графике изобразить точки выборки и эллипс равновероятности.

\section{Теория}

\begin{enumerate}
    \item Двумерное нормально распределение \cite{5_1}:
        \begin{equation}
        N(x,y,0,0,1,1,\rho) = \frac{1}{2\pi\sqrt{1-\rho^2}}e^{-\frac{1}{2(1-\rho^2)}(x^2-2\rho x y+y^2)} \label{dnd}
        \end{equation}
    
    \item Коэффициент корреляции Пирсона \cite{5_2}:
        \begin{equation}
        r_{xy} = \left(\sum\limits_{i=1}^n(x_i-\overline{x})(y_i-\overline{y})\right)\left(\sum\limits_{i=1}^n(x_i-\overline{x})^2\sum\limits_{i=1}^n(y_i-\overline{y})^2\right)^{-\frac{1}{2}} \label{ccp}
        \end{equation}
    \item Коэффициент корреляции Спирмана \cite{5_3}:
        \begin{equation}
        \rho_n = 1 -  \frac{6}{n^3-n}\sum\limits_{i=1}^n d_i^2\label{ccs}
        \end{equation}
        
    \item Квадрантный коэффициент корреляции \cite{5_4}:
        \begin{equation}
        \overset{\wedge}{q} = \frac{1}{n}\sum\limits_{i=1}^n sign(x_i-med\;x)sign(y_i-med\;y)\label{qcc}
        \end{equation}
\end{enumerate}

\section{Реализация}
Работы была выполнена на языке $Python 3.7.$
Для генерации выборок использовался модуль \cite{numpy}.
Для построения графиков использовалась библиотека matplotlib \cite{plotlib}.
Функции распределения обрабатывались при помощи библиотеки scipy.stats \cite{skp}

\section{Результаты}

\begin{table}[H]
\caption{normal}
\label{tab:my_label1}
\begin{center}
\vspace{5mm}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
n = 20    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &0.003889    &-0.001204   &0.004247    &-0.002884   &0.014986    \\
\hline
D =       &0.050065    &0.069428    &0.135281    &0.056127    &0.060241    \\
\hline
n = 60    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &0.005639    &-0.001905   &0.006317    &0.003647    &-0.005183   \\
\hline
D =       &0.017071    &0.024751    &0.109666    &0.020065    &0.019645    \\
\hline
n = 100   &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &-0.000990   &-0.008915   &-0.003211   &-0.007140   &0.000411    \\
\hline
D =       &0.010270    &0.015038    &0.091469    &0.012224    &0.011148    \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{table}[H]
\caption{cauchy}
\label{tab:my_label2}
\begin{center}
\vspace{5mm}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
n = 20    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &0.574031    &-0.009207   &4.314604    &0.009490    &0.024569    \\
\hline
D =       &380.673006  &0.127344    &24864.038520&0.290641    &0.156087    \\
\hline
n = 60    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &16.889466   &0.007131    &-14.877379  &-0.006227   &-0.007330   \\
\hline
D =       &218415.033090&0.039049    &268917.253813&0.087454    &0.042852    \\
\hline
n = 100   &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &-1.147046   &-0.000622   &-23.949387  &-0.002369   &-0.008024   \\
\hline
D =       &604.646590  &0.024850    &1995730.222185&0.051894    &0.023969    \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{table}[H]
\caption{laplace}
\label{tab:my_label3}
\begin{center}
\vspace{5mm}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
n = 20    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &-0.001627   &-0.000952   &0.032669    &0.003535    &0.005730    \\
\hline
D =       &0.045803    &0.031761    &0.402496    &0.046401    &0.033325    \\
\hline
n = 60    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &-0.006856   &-0.002807   &0.050344    &-0.000216   &-0.000712   \\
\hline
D =       &0.016743    &0.009838    &0.431677    &0.017332    &0.009962    \\
\hline
n = 100   &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &-0.000800   &0.001184    &-0.024119   &-0.002611   &-0.000909   \\
\hline
D =       &0.009861    &0.005529    &0.409545    &0.009740    &0.006101    \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{table}[H]
\caption{uniform}
\label{tab:my_label4}
\begin{center}
\vspace{5mm}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
n = 20    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &-0.004788   &0.011925    &-0.000665   &-0.003460   &-0.002870   \\
\hline
D =       &0.049107    &0.134658    &0.013457    &0.071206    &0.097207    \\
\hline
n = 60    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &0.001583    &-0.004005   &-0.001657   &-0.005769   &-0.003667   \\
\hline
D =       &0.016670    &0.045087    &0.001706    &0.024632    &0.033966    \\
\hline
n = 100   &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &0.000676    &0.004193    &-0.000025   &-0.005675   &0.004133    \\
\hline
D =       &0.010255    &0.028780    &0.000621    &0.015457    &0.019007    \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{table}[H]
\caption{poisson}
\label{tab:my_label5}
\begin{center}
\vspace{5mm}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
n = 20    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &2.016900    &1.868000    &2.531500    &1.899250    &1.865800    \\
\hline
D =       &0.099684    &0.179576    &0.290758    &0.133599    &0.115410    \\
\hline
n = 60    &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &2.005733    &1.932500    &2.945000    &1.936875    &1.843400    \\
\hline
D =       &0.033034    &0.054194    &0.233475    &0.034812    &0.041836    \\
\hline
n = 100   &average     &med         &Zr          &Zq          &Ztr r = n/4 \\
\hline
E =       &1.997070    &1.961500    &3.128000    &1.963625    &1.844780    \\
\hline
D =       &0.020288    &0.033268    &0.217616    &0.017067    &0.027989    \\
\hline
\end{tabular}
\end{center}
\end{table}

\section{Обсуждение}

\par При вычислении средних значений пришлось отбрасывать некоторое число знаков после запятой, так как дисперсия может гарантировать порядок точности среднего значения только до первого значащего знака после запятой в дисперсии включительно. Единственное исключение - стандартное распределение Коши, так как оно имеет бесконечную дисперсию, а значит не может гарантировать никакой точности.

\section{Выводы}

\par В процессе работы вычислены значения характеристик положения для определённых распределений на выборках фиксированной мощности и получено следующее ранжирование характеристик положения:

\begin{enumerate}
    \item Стандартное нормальное распределение $$\overline{x} < Z_{tr} < Z_Q < med\;x < Z_R$$
    
    \item Стандартное распределение Коши $$med\;x < Z_Q < Z_{tr} < \overline{x} < Z_R$$
    
    \item Распределение Лапласа (коэффициент масштаба $\sqrt{2}$ коэффициент сдвига равен нулю) $$med\;x < Z_{tr} < \overline{x} < Z_Q < Z_R$$
    
    \item Равномерное распределение на отрезке $\left[-\sqrt{3},\sqrt{3}\right]$ $$Z_R < \overline{x} < Z_{tr} < Z_Q < med\;x$$
    
    \item Распределение Пуассона (значение мат ожидания равно $3$) $$\overline{x} < Z_{tr} < Z_Q < med\;x < Z_R$$
    
\end{enumerate}

\begin{thebibliography}{}
    \bibitem{numpy}  Модуль numpy  -  https://physics.susu.ru/vorontsov/language/numpy.html
    
    \bibitem{average}  
    Выборочное среднее  -  https://en.wikipedia.org/wiki/Sample\_mean\_and\_covariance
    
    \bibitem{med}  
    Выборочная медиана  -  http://femto.com.ua/articles/part\_1/2194.html
    
    \bibitem{mean_extr}  
    Полусумма экстремальных значений  -  https://studopedia.info/8-56888.html
    
    \bibitem{quartiles}  
    Квартили  -  https://studfiles.net/preview/2438125/page:13/
    
    \bibitem{cut_mean}  Усечённое среднее  -  https://ole-olesko.livejournal.com/15773.html
\end{thebibliography}

\section{Приложения}

Исходники: \url{https://github.com/LanskovNV/math_statistics/tree/master/lab_2}

\end{document}

